# Check if nix-shell is available
if has nix-shell; then
  use nix
else
  # Fallback check
  if ! type pkg-config > /dev/null 2>&1 || ! pkg-config --exists boost; then
    echo "Environment not set up correctly. Please run ./setup.sh to install dependencies."
    # We don't automatically run sudo commands here for security/UX reasons.
    # But we could verify other things or set env vars if needed.
  fi
fi

# Unset environment variables that pollute Python 3.13 venv
# (Nix sets these for its Python 3.12, causing ABI mismatches)
unset PYTHONPATH
unset _PYTHON_SYSCONFIGDATA_NAME

# Activate the virtual environment if it exists
if [ -d ".venv" ]; then
  source .venv/bin/activate
fi
